<div class="ocaml_top"><div class="ocaml_summary"/>
<div class="ocaml_content">
<div class="info"><code class="code">File_descr_watcher_intf.S</code> provides an API for for watching a set of file descriptors
to see if they are ready for reading or writing.<p>We have two implementations, one using epoll, and one using select.</p><p>None of the functions need to be thread-safe, with the exception of
<code class="code">thread_safe_check</code>. So that implementations can easily do non-thread-safe actions,
checking for ready I/O is always done in three steps:</p><p>1. <code class="code">pre_check</code>, while holding the async lock
2. <code class="code">thread_safe_check</code>, while not holding the async lock
3. <code class="code">post_check</code>, while holding the async lock</p></div>
<div class="ocaml_module" name="Post"><pre class="odoccode"><span class="keyword">module</span> <a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf.Post" class="ocaml_internal">Post</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><code><span class="TYPEt"><span class="keyword">type</span> t</span> = {</code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.ready">ready</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#Import.File_descr.t">Import.File_descr.t</a> list</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.bad">bad</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#Import.File_descr.t">Import.File_descr.t</a> list</code>;</code></td></tr><tr><td>}</td></tr></table>

<pre class="odoccode"><span class="VALsexp_of_t"><span class="keyword">val</span> sexp_of_t</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf.Post.t" class="ocaml_internal">t</a> -&gt; <a href="http://frenetic-lang.github.io/api//sexplib/#Sexp.t">Sexplib.Sexp.t</a></code></pre>

<pre class="odoccode"><span class="VALempty"><span class="keyword">val</span> empty</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf.Post.t" class="ocaml_internal">t</a></code></pre></div></div>
<div class="ocaml_module" name="Timeout"><pre class="odoccode"><span class="keyword">module</span> <a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf.Timeout" class="ocaml_internal">Timeout</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEt"><span class="keyword">type</span> t</span> = <code class="type">[ `After of <a href="http://frenetic-lang.github.io/api//core/#Std.Time.Span.t">Core.Std.Time.Span.t</a> | `Immediately | `Never ]</code></pre>

<pre class="odoccode"><span class="VALsexp_of_t"><span class="keyword">val</span> sexp_of_t</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf.Timeout.t" class="ocaml_internal">t</a> -&gt; <a href="http://frenetic-lang.github.io/api//sexplib/#Sexp.t">Sexplib.Sexp.t</a></code></pre>
</div></div>
<div class="ocaml_modtype" name="S"><pre class="odoccode"><span class="keyword">module type</span> <a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S" class="ocaml_internal">S</a> = <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEt"><span class="keyword">type</span> t</span></pre><div class="info">A file-descr-watcher is essentially a map from <code class="code">File_descr.t</code> to <code class="code">bool
      Read_write.t</code>, which defines the set of file descriptors being watched, and for each
file descriptor, whether it is being watched for read, write, or both. If a file
descriptor is not being watched for either, it is not in the map.</div>
<div class="ocaml_include" path="http://frenetic-lang.github.io/api//core/#Std.Invariant:S" items="[]" types="[]"><pre class="ocaml_include_handle"><span class="keyword">include</span> <code class="type"><code class="code"><a href="http://frenetic-lang.github.io/api//core/#Std.Invariant:S">Core.Std.Invariant.S</a></code> with type t := <a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.t" class="ocaml_internal">t</a></code></pre><div class="ocaml_summary"/></div>
<pre class="odoccode"><span class="VALbackend"><span class="keyword">val</span> backend</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#Import.Config.File_descr_watcher.t">Import.Config.File_descr_watcher.t</a></code></pre>
<pre class="odoccode"><span class="VALset"><span class="keyword">val</span> set</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.t" class="ocaml_internal">t</a> -&gt; <a href="http://frenetic-lang.github.io/api//async_unix/#Import.File_descr.t">Import.File_descr.t</a> -&gt; bool <a href="http://frenetic-lang.github.io/api//async_unix/#Read_write.t">Read_write.t</a> -&gt; unit</code></pre><div class="info"><code class="code">set</code> alters the map of file descriptors being watched. It will take effect on the
next call to <code class="code">thread_safe_check</code>. Calling <code class="code">set fd</code> with <code class="code">{ read = false, write =
      false }</code> removes <code class="code">fd</code> from the map.</div>
<pre class="odoccode"><span class="VALiter"><span class="keyword">val</span> iter</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.t" class="ocaml_internal">t</a> -&gt; f:(<a href="http://frenetic-lang.github.io/api//async_unix/#Import.File_descr.t">Import.File_descr.t</a> -&gt; <a href="http://frenetic-lang.github.io/api//async_unix/#Read_write.Key.t">Read_write.Key.t</a> -&gt; unit) -&gt; unit</code></pre><div class="info"><code class="code">iter t ~f</code> iterates over every file descriptor in the map, apply <code class="code">f</code> to it once
for each of {`Read,`Write} that it is being watched for.</div>
<div class="ocaml_module" name="Pre"><pre class="odoccode"><span class="keyword">module</span> <a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.Pre" class="ocaml_internal">Pre</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"><div class="info"><code class="code">pre_check t</code> does whatever non-thread-safe work is necessary to prepare for the
system call that checks file descriptors being ready for read or write. <code class="code">pre_check</code>
does not side effect <code class="code">t</code>.</div></div><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEt"><span class="keyword">type</span> t</span></pre>
<pre class="odoccode"><span class="VALsexp_of_t"><span class="keyword">val</span> sexp_of_t</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.Pre.t" class="ocaml_internal">t</a> -&gt; <a href="http://frenetic-lang.github.io/api//sexplib/#Sexp.t">Sexplib.Sexp.t</a></code></pre></div></div>
<pre class="odoccode"><span class="VALpre_check"><span class="keyword">val</span> pre_check</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.t" class="ocaml_internal">t</a> -&gt; <a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.Pre.t" class="ocaml_internal">Pre.t</a></code></pre>
<div class="ocaml_module" name="Check_result"><pre class="odoccode"><span class="keyword">module</span> <a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.Check_result" class="ocaml_internal">Check_result</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"><div class="info"><code class="code">thread_safe_check t pre ~timeout</code> checks the file descriptors for their status and
returns when at least one is available, or the <code class="code">timeout</code> passes.
<code class="code">thread_safe_check</code> does not side effect <code class="code">t</code>. Unlike the rest of the functions in
this module, <code class="code">thread_safe_check</code> is thread safe.</div></div><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEt"><span class="keyword">type</span> t</span></pre>
<pre class="odoccode"><span class="VALsexp_of_t"><span class="keyword">val</span> sexp_of_t</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.Check_result.t" class="ocaml_internal">t</a> -&gt; <a href="http://frenetic-lang.github.io/api//sexplib/#Sexp.t">Sexplib.Sexp.t</a></code></pre></div></div>
<pre class="odoccode"><span class="VALthread_safe_check"><span class="keyword">val</span> thread_safe_check</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.t" class="ocaml_internal">t</a> -&gt; <a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.Pre.t" class="ocaml_internal">Pre.t</a> -&gt; timeout:<a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf.Timeout.t" class="ocaml_internal">Timeout.t</a> -&gt; <a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.Check_result.t" class="ocaml_internal">Check_result.t</a></code></pre>
<pre class="odoccode"><span class="VALpost_check"><span class="keyword">val</span> post_check</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.t" class="ocaml_internal">t</a> -&gt;
<a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.Check_result.t" class="ocaml_internal">Check_result.t</a> -&gt;
[ `Ok of <a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf.Post.t" class="ocaml_internal">Post.t</a> <a href="http://frenetic-lang.github.io/api//async_unix/#Read_write.t">Read_write.t</a> | `Syscall_interrupted | `Timeout ]</code></pre><div class="info"><code class="code">post_check t check_result</code> returns the file descriptors available for read and
write. Any file descriptor appearing in <code class="code">post</code> for read must have been watched
for read, as per <code class="code">set</code>. Similarly for write.</div>
<pre class="odoccode"><span class="VALreset_in_forked_process"><span class="keyword">val</span> reset_in_forked_process</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.t" class="ocaml_internal">t</a> -&gt; unit</code></pre>
<pre class="odoccode"><span class="VALsexp_of_t"><span class="keyword">val</span> sexp_of_t</span> : <code class="type"><a href="http://frenetic-lang.github.io/api//async_unix/#File_descr_watcher_intf:S.t" class="ocaml_internal">t</a> -&gt; <a href="http://frenetic-lang.github.io/api//sexplib/#Sexp.t">Sexplib.Sexp.t</a></code></pre></div></div>


</div></div>